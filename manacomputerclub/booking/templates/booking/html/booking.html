{% load static %}
<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Mana - бронирование</title>
    <head>
      <link
        rel="icon"
        type="image/jpg"
        href="{% static 'mana/imgs/logo.jpg' %}"
      />
    </head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" type="text/css" media="screen" href="{% static 'mana/css/header_footer.css' %}" />
    <link rel="stylesheet" type="text/css" media="screen" href="{% static 'booking/css/order.css' %}" />
    <link rel="stylesheet" type="text/css" media="screen" href="{% static 'mana/css/responsive.css' %}" />
    <script src="{% static 'mana/js/mobile.js' %}"></script>
    <link
      href="https://fonts.googleapis.com/css?family=Quicksand"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v5.1.0/css/all.css"
      integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt"
      crossorigin="anonymous"
    />
    <link
      href="https://fonts.googleapis.com/css?family=Open+Sans"
      rel="stylesheet"
    />
  </head>

  <body>
    <header> 
      
      <div id="logo">        
        <h2> <a href="{% url 'home' %}"> MANA </a></h2>
      </div>

      <nav id="menu">
        <div id="navbar">
          <input id="menu__toggle" type="checkbox" />
          <label class="menu__btn" for="menu__toggle">
              <span></span>
          </label>
          <ul class="menu__box">
            
            <li><a href="{% url 'services' %}"> Услуги и компьютеры </a></li>
            <li><a href="{% url 'news' %}"> Новости </a></li>
            <li><a href="{% url 'about' %}"> Контакты </a></li>
            <li>
              <a class="order" href="{% url 'booking:order' %}"> Забронировать </a>
            </li>
            {% if user.is_authenticated %}
              <li>
                <a class="account" href="{% url 'account' %}"> Личный кабинет: {{ user }} </a>
              </li>
              {% if user.is_authenticated and user.username == "admin" %}
                <li><a class="admin-link"  href="{% url 'admin:login' %}"> Администрирование </a></li>
              {% endif %}
              {% comment %} <li><a class="account" href="{% url 'account' %}">{{ user }}</a></li> {% endcomment %}
              <li>
                <a class="account" href="{% url 'users:logout' %}"> Выйти </a>
              </li>
              {% else %}
              <li>
                <a class="sign" href="{% url 'users:register' %}"> Регистрация </a>
              </li>
              <li><a class="sign" href="{% url 'users:login' %}"> Вход </a></li>
            {% endif %}
      </nav>
    </header>

    <section>
      <div class="form-container">
        <form id="booking-form" method="post" action="">
          {% csrf_token %}
          <h1>Бронирование компьютеров</h1>
          <select name="club" required id="club-select">
            <option value="" disabled selected>Выберите компьютерный клуб</option>
            <option value="Мостовицкая 7">Мостовицкая 7</option>
            <option value="Ленина 101А">Ленина 101А</option>
            <option value="Риммы Юровской 2А">Риммы Юровской 2А</option></select
          ><br /><br />
          <label>Дата:</label>
          <input type="date" name="day" id="day-input" onfocus="this.showPicker()" required /><br /><br />

          <label>Время:</label>

          <input type="time" name="time" id="time-input" onfocus="this.showPicker()" required />

        <br /><br />

          <label>Услуга:</label>
          <select name="service" id="service-select" required>
            <option value="" disabled selected>Выберите услугу</option>
            {% for service in services %}
              <option value="{{ service.title }}">{{ service.title }}</option>
            {% endfor %}
            <select  
          ><br /><br />
          <div id="available-computers">
            <!-- Здесь будет отображаться количество доступных компьютеров -->
          </div>

          <button type="submit">Далее</button>
        </form>
      </div>
    </section>
    <footer id="contact">
      <p class = "footer_name"><a href="{% url 'home' %}">КОМПЬЮТЕРНЫЙ КЛУБ MANA</a></p>
      <ul>
        <p>+7 (922) 900-01-80</p>
        <li>
          <a href="https://vk.com/mana_kirov"
            ><i class="fab fa-vk fa-2x"></i
          ></a>
        </li>
        <li>
          <a href="https://t.me/mana_kirov"
            ><i class="fab fa-telegram fa-2x"></i
          ></a>
        </li>
        <li>
          <a
            href="https://vk.com/away.php?to=https%3A%2F%2Fwww.twitch.tv%2Fmana_off"
            ><i class="fab fa-twitch fa-2x"></i
          ></a>
        </li>
        <li>
          <a href="https://discord.gg/A8pYcmUvqf"
            ><i class="fab fa-discord fa-2x"></i
          ></a>
        </li>
      </ul>
    </footer>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script> 
        const clubSelect = document.getElementById('club-select');
        const dayInput = document.getElementById('day-input');
        const timeInput = document.getElementById('time-input');
        const serviceSelect = document.getElementById('service-select');
        const availableComputersDiv = document.getElementById('available-computers');

        dayInput.addEventListener('change', function() {
          $.ajax({
            data: dayInput.value, // получаяем данные формы
            url: "",
            
        });
        return false; 
        };


        var data = JSON.parse ("{{ data | escapejs }}");
        const availableComputers = data.computers.map(computer => ({
            id: computer.id,
            name: computer.title
        }));
      

        if (serviceSelect) {
          serviceSelect.addEventListener('change', function() {
            const selectedService = serviceSelect.value;
            availableComputersDiv.innerHTML = `
                <p>Доступные компьютеры: ${availableComputers.length}</p>
                <ul>
                    ${availableComputers.map(computer => `<li>${computer.name}</li>`).join('')}
                </ul>
            `;
          }
            // Обновление интерфейса с количеством доступных компьютеров
            
            // if serviceSelect.value == "Обычный зал 1ч." {
              
            // }
            
        
                            
        )};
    </script> 
  </body>
</html>
